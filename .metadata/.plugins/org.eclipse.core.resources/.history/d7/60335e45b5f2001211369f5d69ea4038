/*
 * AudioStorage.cpp
 *
 *  Created on: Jul 11, 2013
 *      Author: oek
 */

#include "AudioStorage.h"
#include <iostream>

int
AudioStorage::LoadFile(Tag association, char* path) {

	icstdsp::AudioFile* new_file = new icstdsp::AudioFile();

	new_file->Load(path);

	AudioBundle bundle = new AudioBundle();
	bundle.file = new_file;
	bundle.tag = association;

	std::cout << "Load file data to assoc: " << association << std::endl;
	files_[association] = add;
	float* pt = add->GetSafePt();
	std::cout << "Pointer to data: " << files_[association]->GetSafePt() << std::endl;
	return 0;
}

float*
AudioStorage::GetData(Tag association) {

	std::cout << "GetData w assoc: " << association << std::endl;
	icstdsp::AudioFile* data;
	data = files_[association];
	std::cout << "data: " << data << std::endl;
	if (data == 0)
		return 0;
	return data->GetSafePt();
}

uint32_t
AudioStorage::GetSize(Tag association) {

	std::cout << "map size: " << files_.size() << std::endl;
	std::map<Tag, icstdsp::AudioFile*>::iterator it = files_.find(association);
	//icstdsp::AudioFile *data = files_[association];

	if (it==files_.end())
//	if (data == 0)
		return 0;
	icstdsp::AudioFile *data = (*it).second;
	return data->GetSize();
}

uint32_t
AudioStorage::GetSampleRate(Tag association) {
	icstdsp::AudioFile *data = files_[association];
	if (data == 0)
		return 0;
	return (uint32_t)data->GetRate();
}

